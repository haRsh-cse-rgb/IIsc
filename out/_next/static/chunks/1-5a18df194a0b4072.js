"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{1:function(e,t,n){n.d(t,{A:function(){return y}});var s=n(7437),a=n(2265),r=n(9637),l=n(1047),o=n(5805),i=n(3774),c=n(2718),d=n(8553),u=n(1197),h=n(8728),m=n(2489),p=n(8293),x=n(2735),f=n(4362),b=n(9376),g=n(7648);let y=e=>{let{children:t}=e,[n,y]=(0,a.useState)(!1),[v,w]=(0,a.useState)(null),[S,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),{user:P,isAuthenticated:E,isAdmin:T,isVolunteer:A}=(0,f.a)(),q=(0,b.usePathname)();(0,b.useRouter)(),(0,a.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{console.log("SW registered:",e),e.update()}).catch(e=>{console.error("SW registration failed:",e)})},[]),(0,a.useEffect)(()=>{let e=window.matchMedia("(display-mode: standalone)").matches,t=/iPad|iPhone|iPod/.test(navigator.userAgent);if(e){j(!1);return}let n=e=>{e.preventDefault(),w(e),j(!0),console.log("Install prompt available")};if(window.addEventListener("beforeinstallprompt",n),t&&!e)j(!0);else{let e=setTimeout(()=>{j(!0)},1e3);return()=>{clearTimeout(e),window.removeEventListener("beforeinstallprompt",n)}}return()=>{window.removeEventListener("beforeinstallprompt",n)}},[]);let C=async()=>{let e=navigator.userAgent,t=/iPad|iPhone|iPod/.test(e),n=/Android/.test(e);if(t||n){let e="/api/download-app?platform=".concat(t?"ios":"android");try{let s=await fetch(e,{method:"HEAD"});if(!s.ok){await s.json().catch(()=>({})),alert("App is being built! Please check back later or contact the administrator.\n\nTo build the app, run:\n1. npm run build\n2. npm run cap:sync\n3. Build APK in Android Studio\n4. Copy APK to public/apps/app-release.apk");return}let a=document.createElement("a");a.href=e,a.download=t?"STIS-Conference.ipa":"STIS-Conference.apk",document.body.appendChild(a),a.click(),document.body.removeChild(a),n?alert('Download started! After downloading:\n1. Open the APK file\n2. Tap "Install"\n3. If prompted, enable "Install from Unknown Sources" in Settings'):alert("Download started! For iOS installation, you may need to use TestFlight or enterprise distribution.")}catch(e){console.error("Download error:",e),alert("Failed to download app. Please try again later or contact support.")}}else if(v)try{v.prompt();let{outcome:e}=await v.userChoice;"accepted"===e&&console.log("App installed successfully!"),w(null),j(!1)}catch(e){console.error("Install prompt error:",e);try{let e=document.createElement("a");e.href="/api/download-app?platform=android",e.download="STIS-Conference.apk",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){alert("Unable to download app. Please try again later.")}}else try{let e=document.createElement("a");e.href="/api/download-app?platform=android",e.download="STIS-Conference.apk",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){alert("Unable to download app. Please try again later.")}},O=[{id:"/",label:"Home",icon:r.Z,path:"/"},{id:"/programs",label:"Programs",icon:l.Z,path:"/programs"},{id:"/halls",label:"Halls",icon:o.Z,path:"/halls"},{id:"/maps",label:"Maps",icon:i.Z,path:"/maps"},{id:"/complaints",label:"Feedback",icon:c.Z,path:"/complaints"},{id:"/events",label:"Events",icon:d.Z,path:"/events"},{id:"/menu",label:"Menu",icon:u.Z,path:"/menu"}];return(T||A)&&O.push({id:"/admin",label:"Admin",icon:h.Z,path:"/admin"}),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("nav",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:(0,s.jsx)(l.Z,{className:"w-6 h-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold",children:"STIS Conference"}),(0,s.jsx)("p",{className:"text-xs text-blue-100",children:"IISc Bangalore"})]})]}),(0,s.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:O.map(e=>{let t=e.icon,n=q===e.path;return(0,s.jsxs)(g.default,{href:e.path,className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ".concat(n?"bg-white text-blue-600 shadow-md":"text-white hover:bg-blue-500"),children:[(0,s.jsx)(t,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:e.label})]},e.id)})}),(0,s.jsx)("button",{onClick:()=>y(!n),className:"md:hidden p-2 rounded-lg hover:bg-blue-500 transition-colors",children:n?(0,s.jsx)(m.Z,{className:"w-6 h-6"}):(0,s.jsx)(p.Z,{className:"w-6 h-6"})})]}),n&&(0,s.jsx)("div",{className:"md:hidden pb-4 space-y-1",children:O.map(e=>{let t=e.icon,n=q===e.path;return(0,s.jsxs)(g.default,{href:e.path,onClick:()=>y(!1),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all ".concat(n?"bg-white text-blue-600":"text-white hover:bg-blue-500"),children:[(0,s.jsx)(t,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:e.label})]},e.id)})})]})}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-6",children:t}),S&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed bottom-4 left-4 right-4 md:hidden z-50",children:(0,s.jsxs)("button",{onClick:C,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg shadow-lg flex items-center justify-center space-x-2 font-medium hover:from-blue-700 hover:to-blue-800 transition-all active:scale-95",children:[(0,s.jsx)(x.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Download as App"})]})}),(0,s.jsx)("div",{className:"hidden md:block fixed bottom-4 right-4 z-50",children:(0,s.jsxs)("button",{onClick:C,className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg shadow-lg flex items-center justify-center space-x-2 font-medium hover:from-blue-700 hover:to-blue-800 transition-all active:scale-95",children:[(0,s.jsx)(x.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Install App"})]})})]}),E&&(0,s.jsxs)("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg text-sm ".concat(S?"hidden md:block":"block"),children:[null==P?void 0:P.name," (",null==P?void 0:P.role,")"]}),N&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Install App"}),(0,s.jsx)("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(m.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold",children:"1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-800 font-medium",children:"Tap the Share button"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:"Look for the share icon at the bottom of your screen"})]})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold",children:"2"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-800 font-medium",children:'Select "Add to Home Screen"'}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:"Scroll down in the share menu to find this option"})]})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold",children:"3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-800 font-medium",children:'Tap "Add"'}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:"The app will appear on your home screen!"})]})]})]}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,s.jsx)("button",{onClick:()=>k(!1),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 transition-all",children:"Got it!"})})]})})]})}},4362:function(e,t,n){n.d(t,{AuthProvider:function(){return i},a:function(){return o}});var s=n(7437),a=n(2265),r=n(1837);let l=(0,a.createContext)(void 0),o=()=>{let e=(0,a.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e},i=e=>{let{children:t}=e,[n,o]=(0,a.useState)(null),[i,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&(c(e),t&&o(JSON.parse(t)))}},[]);let d=async(e,t)=>{let n=await r.h.login(e,t);c(n.token),o(n.user),r.h.setToken(n.token),localStorage.setItem("user",JSON.stringify(n.user))},u=(null==n?void 0:n.role)==="admin",h=(null==n?void 0:n.role)==="volunteer";return(0,s.jsx)(l.Provider,{value:{user:n,token:i,login:d,logout:()=>{o(null),c(null),r.h.setToken(null),localStorage.removeItem("user")},isAdmin:u,isVolunteer:h,isAuthenticated:!!n&&!!i},children:t})}},1837:function(e,t,n){n.d(t,{h:function(){return r}});let s=n(257).env.NEXT_PUBLIC_API_URL||"";class a{setToken(e){this.token=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={"Content-Type":"application/json"};t.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{n[t]=e}):Array.isArray(t.headers)?t.headers.forEach(e=>{let[t,s]=e;n[t]=s}):Object.assign(n,t.headers)),this.token&&(n.Authorization="Bearer ".concat(this.token));let s="".concat(this.baseUrl).concat(e);console.log("API Request: ".concat(t.method||"GET"," ").concat(s));let a=await fetch(s,{...t,headers:n});if(!a.ok){let e=await a.json().catch(()=>({error:"Request failed"}));throw console.error("API Error (".concat(a.status,"):"),e),Error(e.error||"Request failed")}let r=await a.json();return console.log("API Response from ".concat(s,":"),Array.isArray(r)?"".concat(r.length," items"):"object"),r}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async getAnnouncements(e){let t=new URLSearchParams(e).toString();return this.request("/announcements".concat(t?"?".concat(t):""))}async createAnnouncement(e){return this.request("/announcements",{method:"POST",body:JSON.stringify(e)})}async updateAnnouncement(e,t){return this.request("/announcements/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteAnnouncement(e){return this.request("/announcements/".concat(e),{method:"DELETE"})}async getSchedules(e){let t=new URLSearchParams(e).toString();return this.request("/schedules".concat(t?"?".concat(t):""))}async createSchedule(e){return this.request("/schedules",{method:"POST",body:JSON.stringify(e)})}async updateSchedule(e,t){return this.request("/schedules/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteSchedule(e){return this.request("/schedules/".concat(e),{method:"DELETE"})}async getHalls(){return this.request("/halls")}async getHallStatus(){return this.request("/halls/status")}async createHall(e){return this.request("/halls",{method:"POST",body:JSON.stringify(e)})}async updateHall(e,t){return this.request("/halls/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteHall(e){return this.request("/halls/".concat(e),{method:"DELETE"})}async getComplaints(e){let t=new URLSearchParams(e).toString();return this.request("/complaints".concat(t?"?".concat(t):""))}async getPublicComplaints(){return this.request("/complaints/public")}async createComplaint(e){return this.request("/complaints",{method:"POST",body:JSON.stringify(e)})}async updateComplaint(e,t){return this.request("/complaints/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async getEvents(e){let t=new URLSearchParams(e).toString();return this.request("/events".concat(t?"?".concat(t):""))}async createEvent(e){return this.request("/events",{method:"POST",body:JSON.stringify(e)})}async updateEvent(e,t){return this.request("/events/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteEvent(e){return this.request("/events/".concat(e),{method:"DELETE"})}async getUsers(){return this.request("/users")}async updateUser(e,t){return this.request("/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteUser(e){return this.request("/users/".concat(e),{method:"DELETE"})}async getMenus(e){let t=new URLSearchParams(e).toString();return this.request("/menus".concat(t?"?".concat(t):""))}async createMenu(e){return this.request("/menus",{method:"POST",body:JSON.stringify(e)})}async updateMenu(e,t){return this.request("/menus/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteMenu(e){return this.request("/menus/".concat(e),{method:"DELETE"})}getExportUrl(e){return"".concat(this.baseUrl,"/export/").concat(e)}constructor(){this.token=null,this.baseUrl=s?"".concat(s,"/api"):"/api",this.token=localStorage.getItem("token")}}let r=new a}}]);